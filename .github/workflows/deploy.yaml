# test CI
# test code change: addition of env var
name: deploy

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:  
  deploy:
    runs-on: ubuntu-latest

    steps:
        - name: Checkout
          uses: actions/checkout@v4
          with:
            persist-credentials: false

        - name: Setup Flutter
          uses: subosito/flutter-action@v2
          with:
            channel: "stable"
    
        - name: Build Web Application
          run: flutter build web -t lib/main_development.dart

        - name: Copy Build Artifact
          run: |
            [[ -d artifact ]] && rm -r artifact
            mkdir artifact
            cp -R build/web artifacts
        
        - name: Commit the Artifact
          uses: stefanzweifel/git-auto-commit-action@v4
          with:
            commit_message: build:${{ github.sha }}